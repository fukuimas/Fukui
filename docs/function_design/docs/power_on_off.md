## 電源管理
本節では電源管理に関わる機能仕様を明らかにする。
電源管理機能は、デバイスの電源ON/OFFの他、電池容量が不足してきた際のアラートやデバイスが一定時間アイドル状態であった場合に自動で電源をOFFにする(オートパワーオフ、詳細は後述)を実行する。

- 電源ON/OFFは電源ボタンの長押し操作で行う

以下に電源操作に関する仕様を示す。

### 電源ON時の動作

- 電源ボタン押下が1秒以上継続したら電源をONにする。
- 動作モードは360度通話モードを設定する。
- リリースを検出したら、電源OFF監視を開始する。

### 電源OFF時の動作

- 以下の何れかが発生したら電源OFFへ移行を開始する。
    1. 電源ボタン押下が1秒継続
    2. 電池電圧監視において電源低下状態が○〇秒継続
- ユーザが電源ボタンを離すまでDSPへの電源供給は継続するが、動作は止める。


![電源ON/OFFフローチャート](img/power_on_off_flowchart.png)

### 電源の状態

- 電力の状態は以下3パターンとする
    - 正常 / 電力低下 / 電力不足
- 電池残量が一定量(○○V)以下となり状態が遷移したら、アラートを表示する
- アラートは電源表示LEDの色を対象の状態に合わせて変化させる
- 電力不足状態が○○sec継続もしくは、電圧値が○○V以下になったら動作の継続が不可であると判断し、電源OFF操作へ強制的に遷移する

|ボタン種別|内容|
|:--|:--|
|正常|電池残量○○％～100％ までの状態</br>デバイスを動作させるのに十分な電力を供給できる|
|電力低下|電池残量△△％～○○％までの状態</br>デバイスを動作させる事は可能だが電力不足に近づいた</br>正常⇒電力低下に遷移してから30～60分程度動作した後、電力不足に移行</br>する程度の範囲を設定<br>省電力モードで動作する(後述)|
|電力不足|電池残量～△△％までの状態</br>デバイスを動作させるのに必要な電力が供給できなくなる手前まで<br>省電力モードで動作する(後述)|
[電力の状態]

### オートパワーオフ

以下に、オートパワーオフ機能の仕様を示す。

デバイスは一定時間、アイドル状態であった時に、自動で電源をOFFにする。

アイドル状態は、以下の条件を全て満たす状態を定義する。

- Bluetooth接続が接続中以外
- USB接続が未接続

アイドル状態が5分継続した場合、電源OFF操作へ移行する。

